# 09. 타입 변환과 단축 평가

생성일: 2022년 2월 25일 오후 10:15

## 9. 1 타입 변환이란?

개발자가 의도적으로 값의 타입을 변경하는 것을 **명시적 타입** 변환 또는 **타입 캐스팅**이라고 한다.

그와 반대로 자바스크립트 엔진에 의해 암묵적으로 타입을 자동 변환하는 것을 **암묵적 타입변환** 또는 **타입 강제 변환**이라고 한다.

<aside>
💡 타입 변환은 기존 원시값을 변경하는 것이 아니라 다른 타입의 새로운 원시값을 생성하는 것이다.

</aside>

```jsx
var str = '';
console.log(typeof str, str);  // string 10

// x변수의 값이 변경된 것은 아님
console.log(typeof x, x);  // number 10
```

→ 암묵적 타입 변환은 표현식의 에러를 피하기 위해서 피연산자의 값을 암묵적 타입변환해서 새로운 타입의 값을 만들어 한번만 사용하고 버린다.

개발자는 자신이 작성한 코드에서 암묵적 타입 변환이 발생하는지, 발생한다면 어떤  타입의 어떤 값으로 변환되는지, 타입 변환된 값으로 표현식이 어떻게 평가 될 것인지 예측가능해야한다.

---

## 9. 2 암묵적 타입 변환

암묵적 타입 변환이 발생하면 문자열, 숫자, 불리언과 같은 원시 타입 중 하나로 타입을 자동 변환한다.

### 9. 2. 1 문자열 타입으로 변환

```jsx
1 + '2' //  12 -> + 연산자가 피연산자 중 하나가 문자열이기 때문에 문자열 연결 연산자로 동작
`1 + 1 = ${1 + 1}`  // -> " 1 + 1 = 2" 표현식의 평과 결과를 암묵적 타입 변환함
```

→ 이를 위해 자바스크립트 엔진은 문자열 타입이 아닌 피연산자를 문자열 타입으로 암묵적 타입 변환한다.

![Untitled](https://user-images.githubusercontent.com/82594837/155920851-13a34587-2bb0-4dce-a79a-f5f1e1e1530f.png)

### 9. 2. 2 숫자 타입으로 변환

산술연산자 사용 시 결과값은 숫자여야 하기 때문에 피연산자는 모두 숫자 타입이여야한다.

![Untitled 1](https://user-images.githubusercontent.com/82594837/155920855-425983c0-289a-48f0-a2b4-ef88b078acd6.png)

따라서 자바스크립트 엔진은 산술연산자 표현식을 평가하기 위해서 산술연산자의 피연산자중에서 숫자타입이 아닌 피연산자를 숫자타입으로 암묵적 형변환을 하는데, 이 때 숫자타입으로 바꿀 수 없는 경우 표현식의 평가 결과가 NaN이 된다.

```jsx
'1' > 0  // true
```

비교 연산자의 역할은 불리언 값을 만드는 것이다. > 비교 연산자는 피연산자의 크기를 비교하기 때문에 문맥상 모두 숫자여야만한다. 자바스크립트 엔진은 숫자 타입이 아닌 피연산자를 숫자타입으로 암묵적 타입 변환한다.

![Untitled 2](https://user-images.githubusercontent.com/82594837/155920858-9bf85958-3b0f-43a4-a44e-6fd08da49702.png)

### 9. 2. 3 불리언 타입으로 변환

if 문과 for문과 같이 제어문 또는 조건식은 논리적 참/거짓으로 평가되어야 한다. 자바스크립트 엔진은 조건식의 평가결과를 암묵적으로 불리언 타입으로 변환한다.

![Untitled 3](https://user-images.githubusercontent.com/82594837/155920860-616b6c3a-9a81-45bc-a538-898e8b8476f7.png)

자바스크립트 엔진은 불리언 타입이 아닌 값을 truthy값 또는 falsey값으로 구분한다.

![Untitled 4](https://user-images.githubusercontent.com/82594837/155920861-6df24c07-1bce-4363-bad5-6c8c471b6291.png)

---

## 9. 3 명시적 타입 변환

### 9. 3. 1 문자열 타입으로 변환

1. String 생성자 함수를 new 연산자 없이 호출하는 방법
2. Object.prototype.toString 메서드를 사용하는 방법
3. 문자열 연결 연산자를 이용하는 방법

```jsx
	// 1.
  String(1);

	// 2.
  (1).toString();

	// 3.
  1 + '';
```

### 9. 3. 2 숫자 타입으로 변환

1. Number 생성자 함수를 new 연산자 없이 호출하는 방법
2. parseInt, parseFloat 함수를 사용하는 방법
3. +단항 산술 연산자를 사용하는 방법
4. +산술연산자를 이용하는 방법

![Untitled 5](https://user-images.githubusercontent.com/82594837/155920863-41a6f27f-312d-47cb-9dac-8e088c34e46a.png)
![Untitled 6](https://user-images.githubusercontent.com/82594837/155920864-e5783976-4047-4092-9871-5a7adb040bfd.png)

### 9. 3. 3 불리언 타입으로 변환

1. Boolean 생성자 함수를 new 연산자 없이 호출
2. ! 부정 논리 연산자를 두번 사용하는 방법

```jsx
Boolean('x');  // true
!!'x';   // true
!!false;   // false

```

---

## 9. 4 단축평가

**논리합( | | ) 또는 논리곱(&&) 연산자 표현식은 언제나 2개의 피연산자 중에서 하나로 평가된다.**

```jsx
'Cat' && 'Dog'   // Dog 
'Cat' || 'Dog'   // Cat 
```

→ 논리곱 연산자는 둘 다 true 일 경우 true를 반환하기 때문에 위의 경우 두 번째 피연산자에 의해 결과 값이 결정됨

→ 논리합 연산자는 둘 중 하나가 true일 경우 true를 반환하기 때문에 위의 경우 첫 번째 연산 결과에의해 결과 값이 결정됨

<aside>
💡 **단축평가는 표현식을 평가하는 중에 평가 결과가 확정 된 경우 나머지 평가 과정을 생략하는 것을 말한다.**

</aside>

```jsx
// 논리합 연산자
'Cat' || 'Dog'   // 'Dog'
false || 'Dog'   // false
'Cat' || false   // 'Cat'

// 논리곱 연산자
'Cat' && 'Dog'   // 'Dog'
false && 'Dog'   // false
'Cat' && false   // 'Cat'

// 조건이 truthy값 일 때 단축 평가의 if문 대체
var done = 'true';
var message = '';

message = done && '완료';  // 두번 째 값까지 평가해야 하기 때문에 '완료'를 리턴함

// 조건이 falsey값일 때 단축평가의 if문 대체
var done = 'false';
var message = '';

message = done || '미완료';  // 두번째 값이 truthy이기 때문에 '미완료'를 리턴함

// null이거나 undefined인 객체의 프로퍼티를 참조 할 경우 타입에러가 나지만 단축평가를
// 사용하면 이를 방지 할 수 있다.
var elem = null;
var vaule = elem.value;   // Type error

// 단축평가 사용 시
var elem = null;
var value = elem && elem.value; // null 
																// elem이 falsey 값이기 때문에 첫번째 연산자 값 리턴함

// 함수 파라미터에 기본값을 설정 할 때
function getStringLength(str){
    str = str || '';  // 사용하지 않을 경우 에러남
    return str.length;
}
var result = getStringLength();
console.log(result);  // 0
```

---

## 9. 4. 2 옵셔널 체이닝 연산자 - **(?.)**

**옵셔널 체이닝 연산자는 좌항의 피연산자가 null이거나 undefined 일 경우 undefined를 반환하고, 그렇지 않을 경우에는 우항의 프로퍼티 참조를 이어간다.**

```jsx
var elem = null;

// elem이 falsy값이면 elem으로 평가하고, elem이 truty값이면 elem.value로 평가한다.
var value = elem?.value;
console.log(value);   // null
```

**좌항의 피연산자가 falsey 값이라도 그 값이 null이거나 undefined가 아닌 경우에는 우항의 프로퍼티 참조를 이어간다.**

```jsx
var str = '';
var length = str?.length;
console.log(length);   // 0
```

---

## 9. 4. 3 null 병합 연산자 - (??)

**null 병합 연산자는 좌항의 피연산자가 null이거나 undefined인 경우 우항의 피연산자를 반환하기 때문에 기본값을 설정 할 경우 유용하다.**

```jsx
var foo  = null ?? 'default string';
console.log(foo);   // "default string"
```
